### 装饰器

#### 属性描述符

**`Object.getOwnPropertyDescriptors(o, key)`**

```js
const user = {
  name: "张三",
};

console.log(Object.getOwnPropertyDescriptors(user, "name"));

// {
//     name: { value: '张三', writable: true, enumerable: true, configurable: true }
// }
```

### 概述

装饰器和类一起使用，通过装饰器可以<font style="background-color:#ff0">为类附加功能</font>，对类功能进行增强

装饰器其实就是<font color='#8600FF'>函数</font>，可以接收类构造函数、类原型对象等作为参数，在函数内部编写对类功能进行扩展的逻辑

装饰器是实验性特性，使用前需开启 `tsconfig.json` 配置

### 类方法装饰器

装饰器只是一个函数语法糖

`打印错误报告装饰器.ts`

```ts
class Boat {
  @logError
  pilot() {
    console.log("pilot");
    throw new Error("发生了错误");
  }
}

/**
 * @param target 构造函数
 * @param key 目标方法名
 * @param desc
 */
function logError(target: any, key: string, desc: PropertyDescriptor) {
  const method = desc.value;
  // 重写方法
  desc.value = function () {
    try {
      method();
    } catch (e) {
      console.log(key + "方法调用时，发生了错误");
    }
  };
}

const boat = new Boat();
boat.pilot();

```

#### 方式二

需要传参时，返回装饰器函数

```ts
class Boat {
  @logError2("pilot发生错误")
  pilot() {
    console.log("pilot");
    throw new Error("发生了错误");
  }
}

/**
 * @param errMsg 错误信息
 */
function logError2(errMsg: string) {
  return function (target: any, key: string, desc: PropertyDescriptor) {
    const method = desc.value;
    // 重写方法
    desc.value = function () {
      try {
        method();
      } catch (e) {
        console.log(errMsg);
      }
    };
  };
}

const boat = new Boat();
boat.pilot();
```

### 类属性装饰器

```ts
class Boat2 {
  @testDecorator
  color: string = "red";
}

function testDecorator(target: any, key: string) {
  console.log(target, key);
  // {} color
}

```

### 参数装饰器

```
```

